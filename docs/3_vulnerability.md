# Table of Contents
1. [Setup](./1_setup.md)
2. [Emulation](./2_emulation.md)
3. [Vulnerability CVE-2022-27646](./3_vulnerability.md#vulnerability-cve-2022-27646)
4. [Tracing](./4_tracing.md)
5. [Symbolic Execution](./5_symbex.md)
6. [Exploitation](./6_exploitation.md)
<!--TODO--------------------------------------------------------------------------------------------
- [ ] Maybe move to 5_vulnerability.md
- [ ] What is the size of stack buffer `line`?
- [ ] Write text
    - Pre-auth remote code execution vulnerability in NETGEAR R6700v3 routers over the WAN interface
    - The vulnerability resides in binary `/bin/circled`, which occasionally fetches a file named `circleinfo.txt` from remote web servers. When parsed by the binary `circled`, a stack buffer overflow (CVE-2022-27646) can be triggered. Since the download requests from the routers miss certificate validation (CVE-2022-27644), attackers could trick routers to download malicious files (e.g. using DNS or TCP redirection), leading to arbitrary code execution on the routers. Since `circled` runs as root, attackers may gain full privileges on the routers.
    - SHA1 of `/bin/circled`: ac86472cdeccd01165718b1b759073b9e6b665e9
    - In case of a crash, the binary restarts (used to defeat ASRL)
    - Read file `circleinfo.txt` line by line (`fgets` - 1024 bytes), parse two strings per line (`sscanf`)and write them to two stack variables (size 256) without size checking -> stack buffer overflow
--------------------------------------------------------------------------------------------------->
# Vulnerability CVE-2022-27646

`curl -k`
[Defeating the NETGEAR R6700v3](https://www.synacktiv.com/en/publications/pwn2own-austin-2021-defeating-the-netgear-r6700v3.html)

----------------------------------------------------------------------------------------------------
[Back-to-Top](./3_vulnerability.md#table-of-contents)